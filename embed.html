<!-- File: embed.html -->
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Local Lead Finder</title>
    <style>
      /* Reset/structure */
      *, *::before, *::after { box-sizing: border-box; }
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; margin:0; padding:20px; background:#f6f7f9; color:#111; }
      .card { max-width: 720px; margin: 0 auto; background:#fff; border:1px solid #eee; border-radius:16px; box-shadow:0 8px 24px rgba(0,0,0,.06); padding:22px; }
      h1 { font-size: 26px; margin: 0 0 6px; }
      p.small { color:#666; margin: 0 0 18px; }
      label { display:block; margin: 12px 0 6px; font-weight: 600; }
      input, select { width: 100%; padding: 12px; border:1px solid #ddd; border-radius:10px; background:#fff; font-size: 15px; }
      input[type="checkbox"] { width:auto; margin-right:8px; }
      .row { display:grid; grid-template-columns: 1fr 1fr; gap:14px; }
      .mt { margin-top: 14px; }
      button { width:100%; margin-top: 18px; padding: 14px 16px; border:0; border-radius: 12px; background:#111; color:#fff; font-weight:700; font-size:16px; cursor:pointer; }
      button:disabled { opacity: .7; cursor: not-allowed; }
      pre { white-space: pre-wrap; background:#fafafa; border:1px solid #eee; padding:14px; border-radius:12px; margin-top:16px; line-height:1.4; }
      .hide { display:none; }
      .pill { display:inline-block; background:#111; color:#fff; font-size:12px; padding:2px 8px; border-radius:999px; margin-left:6px; }
      .help { font-size:12px; color:#666; margin-top:6px; }
      @media (max-width: 640px){
        .row { grid-template-columns: 1fr; }
        .card { padding:16px; }
        h1 { font-size: 22px; }
      }
      /* tidy checkbox list */
      .checks { display:grid; grid-template-columns: 1fr 1fr; gap:10px 14px; }
      @media (max-width: 480px){ .checks { grid-template-columns: 1fr; } }
      .check { display:flex; align-items:center; }
    </style>
  </head>
  <body>
    <div class="card">
      <h1>Get Your Local Lead Plan</h1>
      <p class="small">Answer ~60 seconds of questions. We’ll generate a plan tailored to your trade & city.</p>

      <div id="form">
        <label>Industry</label>
        <select id="industry" aria-label="Industry">
          <option>Plumbing</option><option>Roofing</option><option>HVAC</option>
          <option>Landscaping</option><option>Solar</option><option>Pest Control</option>
          <option>Cleaning</option><option>Other</option>
        </select>

        <div class="row mt">
          <div>
            <label>City</label>
            <input id="city" placeholder="Clarksville" autocomplete="address-level2" />
          </div>
          <div>
            <label>State</label>
            <input id="state" placeholder="FL" autocomplete="address-level1" />
          </div>
        </div>

        <div class="row mt">
          <div>
            <label>ZIP <span class="small" style="font-weight:400">(optional)</span></label>
            <input id="zip" placeholder="32430" inputmode="numeric" pattern="[0-9]*" />
          </div>
          <div>
            <label>Budget</label>
            <select id="budget">
              <option>0–$500</option><option>$500–$2,000</option><option>$2,000+</option>
            </select>
          </div>
        </div>

        <label class="mt">Timeline</label>
        <select id="timeline">
          <option>Need leads this week</option>
          <option>Building pipeline is fine</option>
        </select>

        <label class="mt">Current Channels <span class="pill">multi-select</span></label>
        <div class="checks" id="channelsWrap">
          <label class="check"><input type="checkbox" value="Google Local Services Ads (LSA)">Google Local Services Ads (LSA)</label>
          <label class="check"><input type="checkbox" value="Google Ads">Google Ads (Search/PMAX)</label>
          <label class="check"><input type="checkbox" value="SEO">SEO</label>
          <label class="check"><input type="checkbox" value="Facebook/Instagram Ads">Facebook/Instagram Ads</label>
          <label class="check"><input type="checkbox" value="Referrals/Partners">Referrals/Partners</label>
          <label class="check"><input type="checkbox" value="Nothing yet">Nothing yet</label>
        </div>
        <div class="help">Tip: If none of these fit, leave them unchecked.</div>

        <label class="mt">Primary Goal</label>
        <select id="goal">
          <option>Phone calls</option><option>Booked appointments</option><option>Any</option>
        </select>

        <div class="row mt">
          <div>
            <label>First Name</label>
            <input id="firstName" autocomplete="given-name" />
          </div>
          <div>
            <label>Last Name</label>
            <input id="lastName" autocomplete="family-name" />
          </div>
        </div>

        <div class="row mt">
          <div>
            <label>Email</label>
            <input id="email" type="email" autocomplete="email" />
          </div>
          <div>
            <label>Phone <span class="small" style="font-weight:400">(optional)</span></label>
            <input id="phone" type="tel" autocomplete="tel" />
          </div>
        </div>

        <button id="go">Generate My Plan</button>
      </div>

      <div id="loading" class="hide">Generating your plan… one sec.</div>
      <pre id="result" class="hide"></pre>
    </div>

    <script>
      const el = id => document.getElementById(id);
      const go = el('go'), loading = el('loading'), result = el('result');

      function getCheckedChannels() {
        return Array.from(document.querySelectorAll('#channelsWrap input[type="checkbox"]:checked'))
          .map(c => c.value);
      }

      go.addEventListener('click', async () => {
        const payload = {
          firstName: el('firstName').value.trim(),
          lastName: el('lastName').value.trim(),
          email: el('email').value.trim(),
          phone: el('phone').value.trim(),
          industry: el('industry').value,
          city: el('city').value.trim(),
          state: el('state').value.trim(),
          zip: el('zip').value.trim(),
          budget: el('budget').value,
          timeline: el('timeline').value,
          channelsUsed: getCheckedChannels(),
          primaryGoal: el('goal').value
        };

        // basic guard on required fields
        if (!payload.industry || !payload.city || !payload.state || !payload.email) {
          alert('Please fill Industry, City, State, and Email.');
          return;
        }

        result.classList.add('hide');
        loading.classList.remove('hide');
        go.disabled = true;

        try {
          const r = await fetch('/api/local-lead-plan', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
          });
          const data = await r.json();
          if (!data.ok) throw new Error(data.error || 'Error');
          result.textContent = data.planText || 'No plan generated.';
          result.classList.remove('hide');
        } catch (e) {
          result.textContent = 'Something went wrong. Please try again.';
          result.classList.remove('hide');
        } finally {
          loading.classList.add('hide');
          go.disabled = false;
          result.scrollIntoView({ behavior: 'smooth' });
        }
      });
    </script>
  </body>
</html>
